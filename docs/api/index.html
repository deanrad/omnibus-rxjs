<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>omnibus-rxjs</title>
	<meta name="description" content="Documentation for omnibus-rxjs">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">omnibus-rxjs</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>omnibus-rxjs</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#omnibus-rxjs" id="omnibus-rxjs" style="color: inherit; text-decoration: none;">
					<h1>omnibus-rxjs</h1>
				</a>
				<p>An Event Bus for RxJS. Ala Redux Middleware (Sagas), with no Redux dependency. </p>
				<a href="#what-is-it" id="what-is-it" style="color: inherit; text-decoration: none;">
					<h2>What Is It?</h2>
				</a>
				<p>A &#39;sugar&#39; around an RxJS Subject, with declarative mapping of Observables.</p>
				<a href="#build-impact" id="build-impact" style="color: inherit; text-decoration: none;">
					<h2>Build Impact?</h2>
				</a>
				<p>Size: &lt;10 Kb minified, gzipped. Tree-shakable to less.</p>
				<a href="#architectural-reason" id="architectural-reason" style="color: inherit; text-decoration: none;">
					<h2>Architectural Reason</h2>
				</a>
				<p>Enables micro-front ends because event bus listeners can be dynamically added and removed. See NextJS example (TODO create).</p>
				<a href="#usage-with-react" id="usage-with-react" style="color: inherit; text-decoration: none;">
					<h2>Usage with React</h2>
				</a>
				<p>Like XState, the Omnibus engine removes async handling from the purview of React. <a href="http://TODO.org">Why is this a good idea?</a>. </p>
				<p>This makes your code future-proof in React, including needing no changes for <a href="https://reactjs.org">Suspense</a> mode. </p>
				<p>Event bus listeners can run <em>before</em> the render cycle, vs <code>useEffect</code> which only runs <strong>after</strong>. This can cut off entire classes of edge cases</p>
				<a href="#usage-with-rxjs" id="usage-with-rxjs" style="color: inherit; text-decoration: none;">
					<h2>Usage with RxJS</h2>
				</a>
				<p>RxJS operators are brilliant and useful, but they tend to couple concepts that are separate. For example, an autocomplete, in RxJS terms is:</p>
				<pre><code class="language-js"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">changeEvents</span><span style="color: #000000"> = </span><span style="color: #795E26">fromEvent</span><span style="color: #000000">(</span><span style="color: #001080">input</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;change&#039;</span><span style="color: #000000">) </span><span style="color: #008000">// </span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">results</span><span style="color: #000000"> = </span><span style="color: #795E26">changeEvents</span><span style="color: #000000">().</span><span style="color: #795E26">pipe</span><span style="color: #000000">(</span>
<span style="color: #000000">     </span><span style="color: #795E26">switchMap</span><span style="color: #000000">(({ </span><span style="color: #001080">value</span><span style="color: #000000">: </span><span style="color: #001080">query</span><span style="color: #000000"> }) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #795E26">getResult$</span><span style="color: #000000">(</span><span style="color: #001080">query</span><span style="color: #000000">))</span>
<span style="color: #000000">   )</span>
<span style="color: #000000">   </span><span style="color: #001080">results</span><span style="color: #000000">.</span><span style="color: #795E26">subscribe</span><span style="color: #000000">(</span><span style="color: #001080">updateUI</span><span style="color: #000000">)</span>
</code></pre>
				<p>Conceptually there are two sources of events - the Observable of <code>changeEvents</code> coming from the user typing in the query input box. For each of those events, an Observable is triggered (which cancels any previous one, per the <code>switchMap</code> concurrency operator).</p>
				<p>A better expression of this architecture can be made in terms of services and an event bus connecting them.</p>
				<pre><code class="language-js"><span style="color: #008000">// bus.js</span>
<span style="color: #008000">// Every item on this bus will be an FSA. Useful to duck-type Redux.</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #001080">bus</span><span style="color: #000000"> = </span><span style="color: #001080">new</span><span style="color: #000000"> </span><span style="color: #001080">Bus</span><span style="color: #000000">&lt;</span><span style="color: #001080">Action</span><span style="color: #000000">&gt;();</span>

<span style="color: #008000">//userService.js</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">bus</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./bus&#039;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">queryCreator</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./search-service&#039;</span>

<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">QueryService</span><span style="color: #000000"> </span><span style="color: #0000FF">implements</span><span style="color: #000000"> </span><span style="color: #267F99">Service</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #001080">currentRun</span><span style="color: #000000">:</span><span style="color: #267F99">Subscription</span>
<span style="color: #000000">  </span><span style="color: #795E26">start</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">currentRun</span><span style="color: #000000">?.</span><span style="color: #795E26">unsubscribe</span><span style="color: #000000">() </span><span style="color: #008000">// restarts it</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">currentRun</span><span style="color: #000000"> = </span><span style="color: #795E26">fromEvent</span><span style="color: #000000">(</span><span style="color: #001080">input</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;click&#039;</span><span style="color: #000000">).</span><span style="color: #795E26">subscribe</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">     </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">event</span><span style="color: #000000"> = </span><span style="color: #795E26">queryCreator</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">target</span><span style="color: #000000">.</span><span style="color: #001080">value</span><span style="color: #000000">)</span>
<span style="color: #000000">      </span><span style="color: #001080">bus</span><span style="color: #000000">.</span><span style="color: #795E26">trigger</span><span style="color: #000000">(</span><span style="color: #001080">event</span><span style="color: #000000">)</span>
<span style="color: #000000">    })</span>

<span style="color: #000000">  }</span>
<span style="color: #000000">  </span><span style="color: #008000">// Stop is barely needed because start() returns the means to stop(), as RxJS Subscriptions do.</span>
<span style="color: #000000">  </span><span style="color: #795E26">stop</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">currentRun</span><span style="color: #000000">?.</span><span style="color: #795E26">unsubscribe</span><span style="color: #000000">()</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>

</code></pre>
				<p> See <a href="https://github.com/deanrad/omnibus-react"><code>omnibus-react</code></a> for React-specific bindings.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-class tsd-has-type-parameter">
						<a href="classes/Omnibus.html" class="tsd-kind-icon">Omnibus</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>